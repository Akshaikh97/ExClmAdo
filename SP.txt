CREATE PROCEDURE GetTotalClaimAmount
AS
BEGIN
    SELECT SUM(ClaimAmount) AS Total FROM ExpenseClaims;
END

CREATE PROCEDURE GetAllEmployees
AS
BEGIN
    SELECT EmployeeId, Name, Code, Designation, Department FROM Employees
END

CREATE PROCEDURE GetAllCategories
AS
BEGIN
    SELECT CategoryId, CategoryName FROM ExpenseCategories
END

CREATE PROCEDURE GetSubcategoriesByCategoryId
    @CategoryId INT
AS
BEGIN
    SELECT SubcategoryId, CategoryId, SubcategoryName 
    FROM ExpenseSubcategories 
    WHERE CategoryId = @CategoryId
END

CREATE PROCEDURE GetSubcategoriesByIds 
    @SubcategoryIds VARCHAR(MAX)
AS
BEGIN
    DECLARE @SQL NVARCHAR(MAX)
    SET @SQL = 'SELECT SubcategoryId, CategoryId, SubcategoryName FROM ExpenseSubcategories WHERE SubcategoryId IN (' + @SubcategoryIds + ')'
    EXEC sp_executesql @SQL
END


CREATE PROCEDURE GetAllClaims
AS
BEGIN
    SELECT ExpenseClaimId, EmployeeId, CategoryId, SubcategoryIds, ClaimAmount, ExpenseDate, ExpenseLocation, BillAttachment, Remarks 
    FROM ExpenseClaims
END

CREATE PROCEDURE [dbo].[AddClaim]
    @EmployeeId INT,
    @CategoryId INT,
    @SubcategoryIds VARCHAR(MAX),
    @ClaimAmount DECIMAL(18, 2),
    @ExpenseDate DATE,
    @ExpenseLocation VARCHAR(100),
    @BillAttachment VARCHAR(200),
    @Remarks VARCHAR(500)
AS
BEGIN
    INSERT INTO ExpenseClaims (EmployeeId, CategoryId, SubcategoryIds, ClaimAmount, ExpenseDate, ExpenseLocation, BillAttachment, Remarks)
    VALUES (@EmployeeId, @CategoryId, @SubcategoryIds, @ClaimAmount, @ExpenseDate, @ExpenseLocation, @BillAttachment, @Remarks)
END